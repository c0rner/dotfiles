#!/bin/sh
TmuxSave="${HOME}/code/scripts/tmux_save"
BackupFile="${HOME}/.tmux.save"

# Check if there are any sessions running
if tmux -q has-session 2>/dev/null; then
   # For some reason 'has-session' on TMUX 1.6 will return ok even though
   # there are no sessions running so we need to double-check.
   typeset -i sessions=$(tmux list-sessions | wc -l)
   if [ ${sessions} -gt 0 ]; then
      [ -r "${BackupFile}" ] && mv "${BackupFile}"{,.old}
      ${TmuxSave} > "${BackupFile}"
   fi
fi
